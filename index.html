<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Support Packages</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #2c3e50; }
        h2 { color: #34495e; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div id="content"></div>

    <script>
        const SHEET_ID = '19U1S1RD2S0dY_zKgE2CPmTp-5O4VUSfXCCC0qLg0oq0';
        const SHEET_NAME = 'Test Page';
        const API_KEY = 'AIzaSyBm8quffA_U1BTUnbBxXeLKuHYyEzLFX7E';

        function fetchSheetData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => renderContent(data.values))
                .catch(error => console.error('Error fetching data:', error));
        }

        function renderContent(data) {
            const contentDiv = document.getElementById('content');
            let html = '';

            data.forEach(row => {
                switch(row[0]) {
                    case 'heading main-title':
                        html += `<h1>${row[2]}</h1>`; // Main title is in column 2
                        break;
                    case 'paragraph description':
                        html += `<p>${row[2]}</p>`; // Description is in column 2
                        break;
                    case 'heading section-title':
                        html += `<h2>${row[2]}</h2>`; // Section title is in column 2
                        break;
                    case 'table':
                        // Check if the row is the "header" row
                        if (row[1] === 'Support Type') { // Check if Support Type is the first column.
                          //Create a header based on first few entries
                            html += `<table><tr><th>${row[1]}</th><th>${row[2]}</th><th>${row[3]}</th><th>${row[4]}</th></tr>`; //Header Row
                        } else {
                            //Create a data row
                            html += `<tr><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}</td><td>${row[4]}</td></tr>`;
                        }
                         html += `</table>`;
                        break;
                }
            });

            contentDiv.innerHTML = html;
        }

        fetchSheetData();
    </script>
</body>
</html>
